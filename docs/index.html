<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hub Maison</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      font-family: sans-serif;
    }

    #trunk {
      display: flex;
      height: 100%;
    }

    /* Right container */
    #main-panel {
      flex: 1;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #f9fafb; /* fallback if image is transparent */
      overflow: hidden;
      height: 100%;
    }

    #sidebar {
      width: 250px;
      height: calc(100vh - 3.5em);
      overflow-y: auto;
      list-style: none;
      padding: 0;
      margin: 0;
      display: flex;
      flex-direction: column;
      position: fixed;
      left: -250px;
      top: 3.5em;
      transition: left 0.3s ease;
      z-index: 990;
    }

    #sidebar.show {
      left: 0;
    }

    #sidebar > li {
      position: relative;
    }

    #sidebar > li:nth-child(even) label {
      background: #f9fafb;
    }

    #sidebar > li:nth-child(odd) label {
      background: #f3f4f6;
    }

    #sidebar a, #sidebar a:visited, #sidebar a:hover {
      text-decoration: none;
      color: black;
    }

    #sidebar label {
      display: block;
      color: black;
      padding: 0.5em;
      cursor: pointer;
      font-weight: bold;
      border: 1px solid #d1d5dc;
      border-bottom: 0;
    }

    #sidebar label::first-letter {
      background-color: #353b46;
      border: 2px solid black;
      padding: 2px;
      border-radius: 4px;
      font-size: 1.4em;
      margin-right: 6px;
    }

    .submenu {
      max-height: 0;
      overflow: hidden;
      background: #ecf0f1;
      transition: max-height 0.3s ease;
    }

    input[type="checkbox"] {
      display: none;
    }

    input[type="checkbox"]:checked + label + .submenu {
      max-height: 500px; /* enough to show content */
    }

    .submenu li {
      padding: 8px 12px;
      list-style-type: none;
    }

    .sebmenu-header {
      font-weight: bold;
      margin-left: -1em;
    }

    .section {
      padding-left: 1em;
    }

    .toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #adacb0;
      color: white;
    }
    .toolbar button {
      background: none;
      border: none;
      color: inherit;
      cursor: pointer;
      padding: 0.5rem;
    }
    .toolbar svg {
      width: 24px;
      height: 24px;
      fill: white;
    }
    li.active {
      background-color: #d0d9e6;
    }

    .nav {
      background-color: #212529;
      height: 3.5em;
      display: flex;
      align-items: center;
      gap: 0.5em;
    }
    .nav a.button {
      background-color: #373a3c;
      color: white;
      text-decoration: none;
      padding: 8px 16px;
      font-size: 16px;
      border-radius: 4px;
      display: inline-block;
    }

    #toggle-sidebar {
      font-size: 24px;
      cursor: pointer;
      background: none;
      color: white;
      padding: 0 0.4em 0.2em 0.4em;
      border: 1px solid white;
      margin: 0.2em 0.5em;
      border-radius: 5px;
    }
  </style>
</head>
<body>
  <div class="nav">
    <button id="toggle-sidebar">☰</button>
    <a href="../../index.html" class="button">↑ Retour</a>
  </div>
  <ul id="sidebar" class="menu">
    <li>
      <input type="checkbox" id="menu7">
      <label for="menu7">📦 Applications</label>
      <ul class="submenu">
        <li><a href="./apps/ai/index.html" id="home-page">🤖 IA</a></li>
        <li><a href="./apps/weather/index.html">🌤️ Météo</a></li>
        <li><a href="">📅 Calendrier</a></li>
        <li><a href="./p/recettes/index.html">🍪 Recettes</a></li>
        <li><a href="">📷 Photos</a></li>
        <li><a href="">📹 Vidéos</a></li>
        <li><a href="">✅ Tâches</a></li>
        <li><a href="./p/accords/index.html">🎸 Accords</a></li>
        <li><a href="">🎨 Apparence</a></li>
        <li><a href="">⚙️ Configuration</a></li>
      </ul>
    </li>
    <li>
      <input type="checkbox" id="menu2">
      <label for="menu2">🏙️ Ville</label>
      <ul class="submenu">
        <li><a href="./files/2025-Calendrier-1A-FR-EN.pdf">♻️ Collecte</a></li>
        <li><a href="https://www.sts.qc.ca/">🚌 Autobus</a></li>
      </ul>
    </li>
    <li>
      <input type="checkbox" id="menu3">
      <label for="menu3">🏠 Maison</label>
      <ul class="submenu">
        <li><a href="">📶 Wifi</a></li>
        <li><a href="">🛋️ Inventaire</a></li>
        <li><a href="">📜 Papiers</a></li>
      </ul>
    </li>
    <li>
      <input type="checkbox" id="menu4">
      <label for="menu4">📝 Pages</label>
      <ul class="submenu">
        <li><a href="./p/vegetation/index.html">🌿 Végétation</a></li>
      </ul>
    </li>
    <li>
      <input type="checkbox" id="menu11">
      <label for="menu11">📁 Fichiers</label>
      <ul class="submenu">
        <li><a>TODO: Use js to update this menu automatically</a></li>
      </ul>
    </li>
    <li>
      <input type="checkbox" id="menu8">
      <label for="menu8">⭐ Favoris</label>
      <ul class="submenu">
        <li><a href="https://pascalr.github.io/">⭐ Site Pascal</a></li>
        <div class="section">
          <li class="sebmenu-header">Streaming</li>
          <li><a href="https://www.primevideo.com/"><img src="./images/prime_video_favicon.png"> Prime Video</a></li>
          <li><a href="https://www.netflix.com/ca/"><img src="./images/netflix.ico" width="18"> Netflix</a></li>
        </div>
      </ul>
    </li>
    <li style="flex-grow: 1;"><label style="height: 100%;"></label></li>
  </ul>
  <div id="main-panel">
    <iframe id="iframe" style="width: 100%; height: 100%; border: 0;"></iframe>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const links = document.querySelectorAll("ul.submenu li a");
      const iframe = document.getElementById("iframe");
      const toggleBtn = document.getElementById('toggle-sidebar');
      const sidebar = document.getElementById('sidebar');
    
      links.forEach(link => {
        link.addEventListener("click", function (e) {
          e.preventDefault();
          document.querySelectorAll("li.active").forEach(p => p.className = "");
          this.parentElement.className = "active"
          let href = this.getAttribute("href");
          location.hash = href;
          iframe.src = href;
          sidebar.classList.toggle('show');
        });
      });

      function loadFromHash() {
        // Remove the leading '#' and decode URI
        let page = location.hash ? decodeURIComponent(location.hash.substring(1)) : null;

        // if (!page) {
        //   // Default page if no hash
        //   page = links[0]?.getAttribute("href") || '';
        //   location.hash = page; // set hash so URL updates
        // }

        if (page) {
          iframe.src = page;
        }
      }

      // Listen for hash changes (back/forward buttons or manual changes)
      window.addEventListener("hashchange", loadFromHash);

      // Initial load from current hash
      loadFromHash();

      let home = document.getElementById("home-page")
      if (home && home.tagName === 'A') { home.click(); }

      toggleBtn.addEventListener('click', () => {
        sidebar.classList.toggle('show');
      });
    });
  </script>
</body>
</html>
