<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hub Maison</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      font-family: sans-serif;
    }

    #trunk {
      display: flex;
      height: 100%;
    }

    /* Right container */
    #main-panel {
      flex: 1;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #f9fafb; /* fallback if image is transparent */
      overflow: hidden;
    }

    .menu {
      width: 250px;
      max-height: 100vh;
      overflow-y: auto;
      list-style: none;
      padding: 0;
      margin: 0;
      display: flex;
      flex-direction: column;
    }

    .menu > li {
      position: relative;
    }

    .menu > li:nth-child(even) label {
      background: #f9fafb;
    }

    .menu > li:nth-child(odd) label {
      background: #f3f4f6;
    }

    .menu a, .menu a:visited, .menu a:hover {
      text-decoration: none;
      color: black;
    }

    .menu label {
      display: block;
      color: black;
      padding: 0.5em;
      cursor: pointer;
      font-weight: bold;
      border: 1px solid #d1d5dc;
      border-bottom: 0;
    }

    .menu label::first-letter {
      background-color: #353b46;
      border: 2px solid black;
      padding: 2px;
      border-radius: 4px;
      font-size: 1.4em;
      margin-right: 6px;
    }

    .submenu {
      max-height: 0;
      overflow: hidden;
      background: #ecf0f1;
      transition: max-height 0.3s ease;
    }

    input[type="checkbox"] {
      display: none;
    }

    input[type="checkbox"]:checked + label + .submenu {
      max-height: 500px; /* enough to show content */
    }

    .submenu li {
      padding: 8px 12px;
      list-style-type: none;
    }

    .sebmenu-header {
      font-weight: bold;
      margin-left: -1em;
    }

    .section {
      padding-left: 1em;
    }

    .toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #adacb0;
      color: white;
    }
    .toolbar button {
      background: none;
      border: none;
      color: inherit;
      cursor: pointer;
      padding: 0.5rem;
    }
    .toolbar svg {
      width: 24px;
      height: 24px;
      fill: white;
    }
    li.active {
      background-color: #d0d9e6;
    }

    .nav {
      background-color: #212529;
      padding: 10px;
      display: flex;
      align-items: center;
    }
    .nav a.button {
      background-color: #373a3c;
      color: white;
      text-decoration: none;
      padding: 10px 16px;
      font-size: 16px;
      border-radius: 4px;
      display: inline-block;
    }
  </style>
</head>
<body>
  <div class="nav">
    <a href="../../index.html" class="button">↑ Retour</a>
  </div>
  <div id="trunk">
    <ul id="sidebar_menu" class="menu">
      <li>
        <input type="checkbox" id="menu7">
        <label for="menu7">📦 Applications</label>
        <ul class="submenu">
          <li><a href="./apps/ai/index.html" id="home-page">🤖 IA</a></li>
          <li><a href="./apps/weather/index.html">🌤️ Météo</a></li>
          <li><a href="">📅 Calendrier</a></li>
          <li><a href="./p/recettes/index.html">🍪 Recettes</a></li>
          <li><a href="">📷 Photos</a></li>
          <li><a href="">📹 Vidéos</a></li>
          <li><a href="">✅ Tâches</a></li>
          <li><a href="./p/accords/index.html">🎸 Accords</a></li>
          <li><a href="">🎨 Apparence</a></li>
          <li><a href="">⚙️ Configuration</a></li>
        </ul>
      </li>
      <li>
        <input type="checkbox" id="menu2">
        <label for="menu2">🏙️ Ville</label>
        <ul class="submenu">
          <li><a href="./files/2025-Calendrier-1A-FR-EN.pdf">♻️ Collecte</a></li>
          <li><a href="https://www.sts.qc.ca/">🚌 Autobus</a></li>
        </ul>
      </li>
      <li>
        <input type="checkbox" id="menu3">
        <label for="menu3">🏠 Maison</label>
        <ul class="submenu">
          <li><a href="">📶 Wifi</a></li>
          <li><a href="">🛋️ Inventaire</a></li>
          <li><a href="">📜 Papiers</a></li>
        </ul>
      </li>
      <li>
        <input type="checkbox" id="menu4">
        <label for="menu4">📝 Pages</label>
        <ul class="submenu">
          <li><a href="./p/vegetation/index.html">🌿 Végétation</a></li>
        </ul>
      </li>
      <li>
        <input type="checkbox" id="menu11">
        <label for="menu11">📁 Fichiers</label>
        <ul class="submenu">
          <li><a>TODO: Use js to update this menu automatically</a></li>
        </ul>
      </li>
      <li>
        <input type="checkbox" id="menu8">
        <label for="menu8">⭐ Favoris</label>
        <ul class="submenu">
          <li><a href="https://pascalr.github.io/">⭐ Site Pascal</a></li>
          <div class="section">
            <li class="sebmenu-header">Streaming</li>
            <li><a href="https://www.primevideo.com/"><img src="./images/prime_video_favicon.png"> Prime Video</a></li>
            <li><a href="https://www.netflix.com/ca/"><img src="./images/netflix.ico" width="18"> Netflix</a></li>
          </div>
        </ul>
      </li>
      <li style="flex-grow: 1;"><label style="height: 100%;"></label></li>
    </ul>
    <div id="main-panel">
      <iframe id="iframe" style="width: 100%; height: 100%; border: 0;"></iframe>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const links = document.querySelectorAll("ul.submenu li a");
      const iframe = document.getElementById("iframe");
    
      links.forEach(link => {

        // Convert links to absolute URLs so when pushState changes URL, it doesn't change relative to that.
        const absoluteUrl = new URL(link.href, window.location.origin).pathname;
        link.href = absoluteUrl

        link.addEventListener("click", function (e) {
          e.preventDefault();
          document.querySelectorAll("li.active").forEach(p => p.className = "");
          this.parentElement.className = "active"
          iframe.src = this.href;
          history.pushState({ iframeSrc: this.href }, '', this.href); // Update URL
        });
      });

      // Load iframe based on URL at page load
      const currentPath = window.location.pathname;

      // Optional: set a default page if root
      if (currentPath === '/' || currentPath === '') {
        let home = document.getElementById("home-page")
        if (home && home.tagName === 'A') { home.click(); }
        //iframe.src = links[0]?.href || '';
        //history.replaceState({ iframeSrc: iframe.src }, '', links[0]?.getAttribute('href'));
      } else {
        iframe.src = currentPath;
        history.replaceState({ iframeSrc: currentPath }, '', currentPath);
      }

      // Back/Forward navigation
      window.addEventListener("popstate", function (event) {
        if (event.state && event.state.iframeSrc) {
          iframe.src = event.state.iframeSrc;
        }
      });
    });
  </script>
</body>
</html>
